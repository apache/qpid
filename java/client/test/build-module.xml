<!--
 -
 - Copyright (c) 2006 The Apache Software Foundation
 -
 - Licensed under the Apache License, Version 2.0 (the "License");
 - you may not use this file except in compliance with the License.
 - You may obtain a copy of the License at
 -
 -    http://www.apache.org/licenses/LICENSE-2.0
 -
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS,
 - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 - See the License for the specific language governing permissions and
 - limitations under the License.
 -
 -->
<project name="Client Tests" default="build">
    <property name="module.depends" value="client broker broker/test common"/>
    <property name="module.dist" value="true"/>

    <import file="../../module.xml"/>

    <target name="test" depends="build">
        <echo>Client Tests</echo>
        <junit fork="yes" printsummary="yes" showoutput="true" haltonfailure="yes" timeout="30000">
            <sysproperty key="amqj.noAutoCreateVMBroker" value="true"/>
            <formatter type="plain"/>
            <classpath refid="module.class.path"/>

            <batchtest fork="yes" todir="${module.test.reports}">
               <fileset dir="${module.src}">
                 <include name="**/test/unit/**/*Test.java"/>                 
                 <exclude name="**/test/unit/**/*UnitTests.java"/>
               </fileset>
             </batchtest>            
        </junit>
    </target>

    <target name="testreport" depends="build">
        <echo>Client Tests with Report</echo>
        <junit fork="yes" printsummary="yes" haltonfailure="no" timeout="30000">
            <sysproperty key="amqj.noAutoCreateVMBroker" value="true"/>
            <formatter type="xml" />
            <classpath refid="module.class.path" />

             <batchtest fork="yes" todir="${module.test.reports}">
               <fileset dir="${module.src}">
                 <include name="**/test/unit/**/*Test.java"/>
                 <exclude name="**/test/unit/**/*UnitTests.java"/>
               </fileset>
             </batchtest>
        </junit>

        <junitreport todir="${module.test.reports}">
            <fileset dir="${module.test.reports}">
                <include name="TEST-*.xml"/>
            </fileset>
            <report todir="${module.test.reports}"/>
        </junitreport>
    </target>


</project>
