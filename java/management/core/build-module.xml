<!--
 -
 - Copyright (c) 2006 The Apache Software Foundation
 -
 - Licensed under the Apache License, Version 2.0 (the "License");
 - you may not use this file except in compliance with the License.
 - You may obtain a copy of the License at
 -
 -    http://www.apache.org/licenses/LICENSE-2.0
 -
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS,
 - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 - See the License for the specific language governing permissions and
 - limitations under the License.
 -
 -->
<project name="AMQ Management Core" default="build">

  <property name="module.depends" value="common,client"/>

  <import file="../../module.xml"/>

  <property name="etc" value="etc"/>
  <property name="xmlbeans.timestamp" value="${module.dir}/xmlbeans.timestamp"/>

  <fileset id="xmlbeans.schema" dir="${etc}" includes="**/*.xsd"/>

  <uptodate property="xmlbeans.done" targetfile="${xmlbeans.timestamp}">
    <srcfiles refid="xmlbeans.schema"/>
  </uptodate>

  <taskdef name="xmlbean" classname="org.apache.xmlbeans.impl.tool.XMLBean" classpathref="module.class.path"/>

  <!-- Generate code from the XML schema -->
  <target name="xmlbeans" unless="xmlbeans.done">
    <xmlbean classgendir="${module.classes}" classpathref="module.class.path"
             failonerror="true" srcgendir="${module.precompiled}"
             javasource="1.5" source="1.5">
      <fileset refid="xmlbeans.schema"/>
    </xmlbean>
    <touch file="${xmlbeans.timestamp}"/>
  </target>

  <target name="precompile" depends="xmlbeans"/>

</project>
