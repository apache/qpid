<?xml version="1.0"?>
<project name="Apache.Qpid.Integration.Tests" default="test">

    <!-- Creates a .dll for this module. -->
    <target name="build">

        <csc target="library"
             define="${build.defines}"
             warnaserror="false" 
             debug="${build.debug}"
             output="${build.dir}/${project::get-name()}.dll">
            
            <sources>
                <include name="**/*.cs" />
            </sources>

            <references>
                <include name="${build.dir}/log4net.dll" />
                <include name="${build.dir}/nunit.framework.dll" />
                <include name="${build.dir}/Apache.Qpid.Common.dll" />
                <include name="${build.dir}/Apache.Qpid.Messaging.dll" />
                <include name="${build.dir}/Apache.Qpid.Client.dll" />
                <include name="${build.dir}/Apache.Qpid.Sasl.dll" />
            </references>
        </csc>

        <!--<copy tofile="${build.dir}/${project::get-name()}.dll.config" file="App.config" />-->
        <copy todir="${build.dir}" file="log4net.config"/>

    </target>

    <!-- Runs all of the tests in this module. -->
    <target name="test" depends="build">
        <nunit2 verbose="true">
            <formatter type="${nant.formatter}" usefile="true" outputdir="${build.dir}/testresults/" extension="txt"/>
            <formatter type="Plain" usefile="false"/>
            <test>
                <assemblies>
                    <include name="${build.dir}/${project::get-name()}.dll"/>
                </assemblies>
                <categories>
                    <include name="Integration"/>
                </categories>
            </test>
        </nunit2>
    </target>

</project>
